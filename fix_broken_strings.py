#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ–º–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–º–æ–¥–∑–∏
"""


def fix_broken_strings():
    """–ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª–æ–º–∞–Ω–Ω—ã–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏"""
    print("üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–æ–º–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫...")

    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
    try:
        with open('bot/main.py', 'r', encoding='utf-8') as f:
            content = f.read()
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}")
        return False

    # –ó–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    fixes = [
        # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –ø–æ—Å–ª–µ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        ('            "intro": """üí∏', '            # "intro": """üí∏'),
        ('            "key_points": """üéØ', '            # "key_points": """üéØ'),

        # –î—Ä—É–≥–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
        ('"intro": """', '# "intro": """'),
        ('"key_points": """', '# "key_points": """'),
        ('"content": """', '# "content": """'),

        # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ–¥–∏–Ω–æ–∫–∏–µ —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        ('            """', '            # """'),
        ('        """', '        # """'),
    ]

    fixed_count = 0
    original_content = content

    for old, new in fixes:
        if old in content:
            content = content.replace(old, new)
            fixed_count += 1
            print(f"–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: {old[:30]}... ‚Üí {new[:30]}...")

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏—â–µ–º –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã
    lines = content.split('\n')
    for i, line in enumerate(lines):
        # –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø—Ä–æ–±–µ–ª–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        if line.strip().startswith('"') and '"""' in line and not line.strip().startswith('#'):
            lines[i] = line.replace(line.strip(), f"# {line.strip()}")
            print(f"Line {i+1}: –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å –∫–∞–≤—ã—á–∫–∞–º–∏")
            fixed_count += 1

    content = '\n'.join(lines)

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
    try:
        with open('bot/main.py', 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ {fixed_count} –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π!")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞: {e}")
        return False


if __name__ == "__main__":
    fix_broken_strings()
